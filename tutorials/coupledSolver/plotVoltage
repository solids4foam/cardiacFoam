#!/bin/bash

# Plot active tension and single-cell voltage (scaled) on the same figure.
# Usage:
#   ./plotVoltage [activeTension.txt] [singleCell.txt]

active_file=${1:-activeTension.txt}
voltage_file=${2:-AlievPanfilov_myocyte_S1_77.5.txt}

if [ ! -f "$active_file" ]; then
    echo "Missing file: $active_file"
    exit 1
fi

if [ ! -f "$voltage_file" ]; then
    echo "Missing file: $voltage_file"
    exit 1
fi

gnuplot -persist <<EOF_PLOT
set term qt font "DejaVu Sans,10"
set title "Active Tension and Single-Cell Voltage"
set xlabel "time"
set ylabel "u, Ta"
set key outside
plot \
    "$active_file" using 1:(\$2/60.0) with lines title "Ta", \
    "$voltage_file" using 1:((\$2+80.0)/100.0) with lines title "u (scaled)"
EOF_PLOT
