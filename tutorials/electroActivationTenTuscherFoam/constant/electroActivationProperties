/*--------------------------------*- C++ -*----------------------------------*	\
| =========                 |                                                 |
| \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\    /   O peration     | Version:  v1912                                 |
|   \\  /    A nd           | Website:  www.openfoam.com                      |
|    \\/     M anipulation  |                                                 |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "constant";
    object      electroActivationProperties;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

// Niederer et al 2011 transversely isotropic conductivity [S/m]
// sigmaX = 0.1334177215;
// sigmaY/Z = 0.01760617761;
conductivity [-1 -3 3 0 0 2 0] (0.1334177215 0 0 0.01760617761 0 0.01760617761);

// Cellular membrane surface-to-volume ratio [1/m]
beta    [0 -1 0 0 0 0 0] 140000;

// Cellular membrane capacitance [F/m^2]
Cm      [-1 -4 4 0 0 2 0] 0.01;

// External stimulus current location
stimulusLocationMin    (0 0 5.5e-3);
stimulusLocationMax    (1.5e-3 1.5e-3 7e-3);

// External stimulus current duration
stimulusDuration    [0 0 1 0 0 0 0] 2e-3;

// External stimulus current intensity [A/m^2]
// Per A/m^2 is calculated as A/m^3 * beta (above)
//stimulusIntensity   [0 -2 0 0 0 1 0] 0.000000357142857;
// External stimulus current intensity [A/m^3]
// 50000 micro A/cm3 == 50000 A/m3
stimulusIntensity   [0 -3 0 0 0 1 0] 50000;

ionicModelCoeffs
{
	tissue mCells
	ionicModel TNNP
    // ODE solver
    solver    RKF45;
    //solver    Euler;

    tissue mCells;

    // Maximum number of steps
    maxSteps 1000000000;

    // Relative tolerance
    // Defaults to 1e-4
    //relTol 1e-6;

    // Absolute tolerance
    // Defaults to 1e-15
    //absTol 1e-6;

    // Initial step size for ODE solver
    initialODEStep 1e-5;
}

// ************************************************************************* //
